apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: healingpolicies.healing.autocura-cognitiva.io
spec:
  group: healing.autocura-cognitiva.io
  names:
    kind: HealingPolicy
    listKind: HealingPolicyList
    plural: healingpolicies
    shortNames:
    - hp
    singular: healingpolicy
  scope: Cluster
  versions:
  - additionalPrinterColumns:
    - jsonPath: .status.lastAppliedStatus
      name: Status
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    name: v1
    schema:
      openAPIV3Schema:
        description: HealingPolicy define uma política de healing para recursos Kubernetes
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            description: HealingPolicySpec define a especificação desejada para uma
              HealingPolicy
            properties:
              actions:
                description: Ações a serem executadas quando as condições são atendidas
                items:
                  description: HealingAction define uma ação de healing a ser executada
                  properties:
                    params:
                      additionalProperties:
                        type: string
                      description: Parâmetros específicos da ação
                      type: object
                    type:
                      description: Tipo de ação (Restart, Scale, Recreate, etc.)
                      type: string
                  required:
                  - type
                  type: object
                type: array
              checkInterval:
                description: Intervalo de verificação em segundos
                format: int32
                type: integer
              conditions:
                description: Condições que acionam o healing
                items:
                  description: HealingCondition define uma condição que aciona o healing
                  properties:
                    minDuration:
                      description: Duração mínima da condição antes de acionar o healing
                        (em segundos)
                      format: int32
                      type: integer
                    status:
                      description: Status esperado (True, False, Unknown)
                      type: string
                    type:
                      description: Tipo de condição (Ready, Available, etc.)
                      type: string
                  required:
                  - status
                  - type
                  type: object
                type: array
              maxAttempts:
                description: Número máximo de tentativas de healing
                format: int32
                type: integer
              selector:
                description: Seletor para os recursos alvo desta política
                properties:
                  matchExpressions:
                    description: matchExpressions is a list of label selector requirements.
                      The requirements are ANDed.
                    items:
                      description: A label selector requirement is a selector that contains
                        values, a key, and an operator that relates the key and values.
                      properties:
                        key:
                          description: key is the label key that the selector applies
                            to.
                          type: string
                        operator:
                          description: operator represents a key's relationship to a
                            set of values. Valid operators are In, NotIn, Exists and
                            DoesNotExist.
                          type: string
                        values:
                          description: values is an array of string values. If the operator
                            is In or NotIn, the values array must be non-empty. If the
                            operator is Exists or DoesNotExist, the values array must
                            be empty. This array is replaced during a strategic merge
                            patch.
                          items:
                            type: string
                          type: array
                      required:
                      - key
                      - operator
                      type: object
                    type: array
                  matchLabels:
                    additionalProperties:
                      type: string
                    description: matchLabels is a map of {key,value} pairs. A single
                      {key,value} in the matchLabels map is equivalent to an element
                      of matchExpressions, whose key field is "key", the operator is
                      "In", and the values array contains only "value". The requirements
                      are ANDed.
                    type: object
                type: object
              targetKind:
                description: Tipo de recurso alvo (Pod, Deployment, etc.)
                type: string
              targetNamespace:
                description: Namespace alvo (vazio para todos os namespaces)
                type: string
            required:
            - actions
            - conditions
            - selector
            - targetKind
            type: object
          status:
            description: HealingPolicyStatus define o status observado de uma HealingPolicy
            properties:
              appliedCount:
                description: Número de vezes que esta política foi aplicada
                format: int32
                type: integer
              lastAppliedMessage:
                description: Mensagem da última aplicação
                type: string
              lastAppliedStatus:
                description: Status da última aplicação (Succeeded, Failed)
                type: string
              lastAppliedTime:
                description: Última vez que esta política foi aplicada
                format: date-time
                type: string
              monitoredResources:
                description: Recursos atualmente monitorados por esta política
                items:
                  type: string
                type: array
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
status:
  acceptedNames:
    kind: HealingPolicy
    listKind: HealingPolicyList
    plural: healingpolicies
    shortNames:
    - hp
    singular: healingpolicy
  conditions:
  - lastTransitionTime: "2023-04-26T01:00:00Z"
    message: no conflicts found
    reason: NoConflicts
    status: "True"
    type: NamesAccepted
  - lastTransitionTime: "2023-04-26T01:00:00Z"
    message: the initial names have been accepted
    reason: InitialNamesAccepted
    status: "True"
    type: Established
  storedVersions:
  - v1
